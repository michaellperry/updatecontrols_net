<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">


<!-- Mirrored from updatecontrols.net/doc/comment/reply/36 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:55:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Reply to comment | Update Controls .NET</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../blogapi/wlwmanifest.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../blogapi/rsd" />
<link rel="prev" href="../../advanced/dependent-properties.html" />
<link rel="up" href="../../advanced.html" />
<link rel="shortcut icon" href="../../http_/updatecontrols.net/favicon.html" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../../modules/book/book4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/updatecontrols/html-elements4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/tabs4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/messages4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/block-editing4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/wireframes4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/updatecontrols/layout4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/updatecontrols/updatecontrols4b43.css?r" />
<link type="text/css" rel="stylesheet" media="print" href="../../sites/all/themes/updatecontrols/print4b43.css?r" />
<!--[if IE]>
<link type="text/css" rel="stylesheet" media="all" href="/doc/sites/all/themes/zen/zen/ie.css?r" />
<![endif]-->
  <script type="text/javascript" src="../../misc/jquery4b43.js?r"></script>
<script type="text/javascript" src="../../misc/drupal4b43.js?r"></script>
<script type="text/javascript" src="../../sites/all/modules/mollom/mollom4b43.js?r"></script>
<script type="text/javascript" src="../../misc/textarea4b43.js?r"></script>
<script type="text/javascript" src="../../misc/collapse4b43.js?r"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/doc/", "googleanalytics": { "trackOutgoing": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|avi|csv|doc|exe|flv|gif|gz|jpe?g|js|mp(3|4|e?g)|mov|pdf|phps|png|ppt|rar|sit|tar|torrent|txt|wma|wmv|xls|xml|zip" } });
//--><!]]>
</script>
</head>
<body class="not-front not-logged-in one-sidebar sidebar-left page-comment-reply-36 section-comment">

  <div id="page"><div id="page-inner">

    <a name="top" id="navigation-top"></a>
          <div id="skip-to-nav"><a href="#navigation">Skip to Navigation</a></div>
    
    <div id="header"><div id="header-inner" class="clear-block">

              <div id="logo-title">

                      <div id="logo"><a href="../../index.html" title="Home" rel="home"><img src="../../images/logosmall.jpg" alt="Home" id="logo-image" /></a></div>
          
                                    <div id="site-name"><strong>
                <a href="../../index.html" title="Home" rel="home">
                Update Controls .NET                </a>
              </strong></div>
                      
          
        </div> <!-- /#logo-title -->
      
      
    </div></div> <!-- /#header-inner, /#header -->

    <div id="main"><div id="main-inner" class="clear-block with-navbar">

      <div id="content"><div id="content-inner">

        
        
                  <div id="content-header">
            <div class="breadcrumb"><a href="../../index.html">Home</a> › <a href="../../advanced/fields-and-collections.html">Fields and collections using generics</a> › </div>                          <h1 class="title">Reply to comment</h1>
                                                          </div> <!-- /#content-header -->
        
        <div id="content-area">
          <div id="node-36" class="node node-type-blog"><div class="node-inner">

  
      <h2 class="title">
      <a href="../../advanced/fields-and-collections.html" title="Fields and collections using generics">Fields and collections using generics</a>
    </h2>
  
  
      <div class="meta">
              <div class="submitted">
          Submitted by MichaelLPerry on Wed, 03/16/2011 - 16:33        </div>
      
          </div>
  
  <div class="content">
    <p>Thanks to code contributions from David Piepgrass and Timothy Pratley, there is a new way to declare fields and collections in Update Controls. No longer do you have to declare sentries. No longer do you have to use the Ctrl+D, G code generator. Now you can use generics.</p>
<p>UpdateControls.Fields</p>
<ul>
<li>Independent&lt;T&gt; </li>
<li>Dependent&lt;T&gt; </li>
</ul>
<p>UpdateControls.Collections</p>
<ul>
<li>IndependentList&lt;T&gt; </li>
<li>IndependentDictionary&lt;Key, Value&gt; </li>
<li>DependentList&lt;T&gt; </li>
</ul>
<h3>Independent fields</h3>
<p>Models contain independent fields. User actions change these fields. Declare an independent field using Independent&lt;T&gt;.</p>
<pre class="code"><span style="color: blue">public class </span><span style="color: #2b91af">Agent
</span>{
    <span style="color: blue">private </span><span style="color: #2b91af">Independent</span>&lt;<span style="color: blue">string</span>&gt; _name = <span style="color: blue">new </span><span style="color: #2b91af">Independent</span>&lt;<span style="color: blue">string</span>&gt;();

    <span style="color: blue">public string </span>Name
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_name; }
        <span style="color: blue">set </span>{ _name.Value = <span style="color: blue">value</span>; }
    }
}</pre><p>The property exposes the field as the native type. Independent&lt;T&gt; is implicitly convertable to T, so the getter returns it directly. The opposite is not true, however, so the setter needs to assign to the Value property.</p>
<h3>Independent collections</h3>
<p>The Independent&lt;T&gt; class is useful only for single-valued fields. Do not try to combine it with a collection class. Instead, use IndependentList&lt;T&gt; or IndependentDictionary&lt;Key, Value&gt;.</p>
<pre class="code"><span style="color: blue">public class </span><span style="color: #2b91af">Agency
</span>{
    <span style="color: blue">private </span><span style="color: #2b91af">IndependentList</span>&lt;<span style="color: #2b91af">Agent</span>&gt; _agents = <span style="color: blue">new </span><span style="color: #2b91af">IndependentList</span>&lt;<span style="color: #2b91af">Agent</span>&gt;();
    <span style="color: blue">private </span><span style="color: #2b91af">IndependentDictionary</span>&lt;<span style="color: #2b91af">Case</span>, <span style="color: #2b91af">Agent</span>&gt; _leadByCase = <span style="color: blue">new </span><span style="color: #2b91af">IndependentDictionary</span>&lt;<span style="color: #2b91af">Case</span>,<span style="color: #2b91af">Agent</span>&gt;();

    <span style="color: blue">public </span><span style="color: #2b91af">IEnumerable</span>&lt;<span style="color: #2b91af">Agent</span>&gt; Agents
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_agents; }
    }

    <span style="color: blue">public void </span>AddAgent(<span style="color: #2b91af">Agent </span>agent)
    {
        _agents.Add(agent);
    }

    <span style="color: blue">public void </span>RemoveAgent(<span style="color: #2b91af">Agent </span>agent)
    {
        _agents.Remove(agent);
    }

    <span style="color: blue">public </span><span style="color: #2b91af">Agent </span>GetLeadForCase(<span style="color: #2b91af">Case </span>c)
    {
        <span style="color: blue">return </span>_leadByCase[c];
    }

    <span style="color: blue">public void </span>SetLeadForCase(<span style="color: #2b91af">Case </span>c, <span style="color: #2b91af">Agent </span>lead)
    {
        _leadByCase[c] = lead;
    }
}</pre><p>These two classes are used the same as regular List&lt;T&gt; and Dictionary&lt;Key, Value&gt;. The only difference is that they participate in dependency tracking.</p>
<h3>Dependent fields</h3>
<p>Whereas a model contains independents, a view model contains dependents. User input does not directly change dependents. Instead, dependents are calculated. Update Controls automatically turns all view model properties into dependents, but you still might want to use Dependent&lt;T&gt; to cache expensive calculations.</p>
<pre class="code"><span style="color: blue">public class </span><span style="color: #2b91af">AgentViewModel
</span>{
    <span style="color: blue">private </span><span style="color: #2b91af">Agent </span>_agent;

    <span style="color: blue">private </span><span style="color: #2b91af">Dependent</span>&lt;<span style="color: blue">int</span>&gt; _totalCasesSolved;

    <span style="color: blue">public </span>AgentViewModel(<span style="color: #2b91af">Agent </span>agent)
    {
        _agent = agent;

        _totalCasesSolved = <span style="color: blue">new </span><span style="color: #2b91af">Dependent</span>&lt;<span style="color: blue">int</span>&gt;(() =&gt; _agent.Cases.Count(c =&gt; c.IsSolved));
    }

    <span style="color: blue">public int </span>TotalCasesSolved
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_totalCasesSolved; }
    }
}</pre><p>The constructor takes a lambda expression that calculates the dependent value. It is cached in the field. Dependent&lt;T&gt; is implicitly convertable to T, so the property returns it directly. When the independent is changed, the dependent is recalculated. You cannot set the Value of a dependent.</p>
<h3>Dependent collections</h3>
<p>Rather than caching one single value, a view model can also cache a collection of objects. When doing so, use DependentList&lt;T&gt;.</p>
<pre class="code"><span style="color: blue">class </span><span style="color: #2b91af">AgencyViewModel
</span>{
    <span style="color: blue">private </span><span style="color: #2b91af">Agency </span>_agency;

    <span style="color: blue">private </span><span style="color: #2b91af">DependentList</span>&lt;<span style="color: #2b91af">AgentViewModel</span>&gt; _agentViewModels;

    <span style="color: blue">public </span>AgencyViewModel(<span style="color: #2b91af">Agency </span>agency)
    {
        _agency = agency;

        _agentViewModels = <span style="color: blue">new </span><span style="color: #2b91af">DependentList</span>&lt;<span style="color: #2b91af">AgentViewModel</span>&gt;(() =&gt;
            <span style="color: blue">from </span>a <span style="color: blue">in </span>_agency.Agents
            <span style="color: blue">select new </span><span style="color: #2b91af">AgentViewModel</span>(a)
        );
    }

    <span style="color: blue">public </span><span style="color: #2b91af">IEnumerable</span>&lt;<span style="color: #2b91af">AgentViewModel</span>&gt; AgentViewModels
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_agentViewModels; }
    }
}</pre><p>The constructor takes a lambda which produces a collection. Typically, it will do so with a linq expression. The field caches the generated collection, and the property returns it as IEnumerable&lt;T&gt;.</p>
<p>DependentList&lt;T&gt; uses <a href="../../advanced/object-recycling.html">object recycling</a> to reuse elements of the collection. If an object was already in the collection and it is returned from the linq query, then the existing object is reused. So if it in turn has dependent fields or collections, those dependents are not recalculated. To support object recycling, the elements of the collection must implement Equals, GetHashCode, and Dispose.</p>
<pre class="code"><span style="color: blue">public class </span><span style="color: #2b91af">AgentViewModel </span>: <span style="color: #2b91af">IDisposable
</span>{
    ...
    <span style="color: blue">public override bool </span>Equals(<span style="color: blue">object </span>obj)
    {
        <span style="color: blue">if </span>(obj == <span style="color: blue">this</span>)
            <span style="color: blue">return true</span>;
        <span style="color: #2b91af">AgentViewModel </span>that = obj <span style="color: blue">as </span><span style="color: #2b91af">AgentViewModel</span>;
        <span style="color: blue">if </span>(that == <span style="color: blue">null</span>)
            <span style="color: blue">return false</span>;
        <span style="color: blue">return this</span>._agent == that._agent;
    }

    <span style="color: blue">public override int </span>GetHashCode()
    {
        <span style="color: blue">return </span>_agent.GetHashCode();
    }

    <span style="color: blue">public void </span>Dispose()
    {
    }
}</pre><p>The Dispose method will be called for objects removed from the dependent collection, so you can use it to manage any extra resources required to represent the collection in an external system. If you have no such resources, leave the body of Dispose blank.</p>
<p>These new generics should make it easier to declare independent fields and collections in the model, and dependent fields and collections in the view model. With them, no plug in or generated code is required.</p>
  <div id="book-navigation-32" class="book-navigation">
    
        <div class="page-links clear-block">
              <a href="../../advanced/dependent-properties.html" class="page-previous" title="Go to previous page">‹ Dependent properties</a>
                    <a href="../../advanced.html" class="page-up" title="Go to parent page">up</a>
                </div>
    
  </div>
  </div>

  <ul class="links inline"><li class="blog_usernames_blog first"><a href="../../blog/1.html" title="Read MichaelLPerry&#039;s latest blog entries.">MichaelLPerry&#039;s blog</a></li>
<li class="comment_add last active"><a href="36.html#comment-form" title="Share your thoughts and opinions related to this posting." class="active">Add new comment</a></li>
</ul>
</div></div> <!-- /node-inner, /node -->
<div class="box"><div class="box-inner">

      <h2 class="title">Reply</h2>
  
  <div class="content">
    <form action="http://updatecontrols.net/doc/comment/reply/36"  accept-charset="UTF-8" method="post" id="comment-form">
<div><div class="form-item" id="edit-subject-wrapper">
 <label for="edit-subject">Subject: </label>
 <input type="text" maxlength="64" name="subject" id="edit-subject" size="60" value="" class="form-text" />
</div>
<div class="form-item" id="edit-comment-wrapper">
 <label for="edit-comment">Comment: <span class="form-required" title="This field is required.">*</span></label>
 <textarea cols="60" rows="15" name="comment" id="edit-comment"  class="form-textarea resizable required"></textarea>
</div>
<fieldset class=" collapsible collapsed"><legend>Input format</legend><div class="form-item" id="edit-format-1-wrapper">
 <label class="option" for="edit-format-1"><input type="radio" id="edit-format-1" name="format" value="1"   class="form-radio" /> Filtered HTML</label>
 <div class="description"><ul class="tips"><li>Web page addresses and e-mail addresses turn into links automatically.</li><li>Allowed HTML tags: &lt;a&gt; &lt;em&gt; &lt;strong&gt; &lt;cite&gt; &lt;code&gt; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &lt;dl&gt; &lt;dt&gt; &lt;dd&gt;</li><li>Lines and paragraphs break automatically.</li></ul></div>
</div>
<div class="form-item" id="edit-format-2-wrapper">
 <label class="option" for="edit-format-2"><input type="radio" id="edit-format-2" name="format" value="2"  checked="checked"  class="form-radio" /> Full HTML</label>
 <div class="description"><ul class="tips"><li>Web page addresses and e-mail addresses turn into links automatically.</li><li>Lines and paragraphs break automatically.</li></ul></div>
</div>
<p><a href="../../filter/tips.html">More information about formatting options</a></p></fieldset>
<input type="hidden" name="form_build_id" id="form-8d36def70525e846d9f95fbeb2e3dc5e" value="form-8d36def70525e846d9f95fbeb2e3dc5e"  />
<input type="hidden" name="form_id" id="edit-comment-form" value="comment_form"  />
<input type="hidden" name="mollom[session_id]" id="edit-mollom-session-id" value=""  class="mollom-session-id" />
<div class="description mollom-privacy">By submitting this form, you accept the <a href="http://mollom.com/web-service-privacy-policy">Mollom privacy policy</a>.</div><input type="submit" name="op" id="edit-preview" value="Preview"  class="form-submit" />

</div></form>
  </div>

</div></div> <!-- /box-inner, /box -->
        </div>

        
        
      </div></div> <!-- /#content-inner, /#content -->

              <div id="navbar"><div id="navbar-inner" class="clear-block region region-navbar">

          <a name="navigation" id="navigation"></a>

          
                      <div id="primary">
              <ul class="links"><li class="menu-146 first"><a href="../../../cs/index-2.html" title="">WPF</a></li>
<li class="menu-147"><a href="../../../cs/silverlight.html" title="">Silverlight</a></li>
<li class="menu-148"><a href="../../../cs/winforms.html" title="">Winforms</a></li>
<li class="menu-149"><a href="../../../cs/download.html" title="">Download</a></li>
<li class="menu-150"><a href="../../index.html" title="">Documentation</a></li>
<li class="menu-151"><a href="../../../cs/videos.html" title="">Videos</a></li>
<li class="menu-152 last"><a href="../../../cs/contact.html" title="">Contact Us</a></li>
</ul>            </div> <!-- /#primary -->
          
          
          
        </div></div> <!-- /#navbar-inner, /#navbar -->
      
              <div id="sidebar-left"><div id="sidebar-left-inner" class="region region-left">
          <div id="block-book-0" class="block block-book region-odd odd region-count-1 count-1"><div class="block-inner">

      <h2 class="title">Sections</h2>
  
  <div class="content">
    <div id="book-block-menu-43" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../../basics.html">The Basics</a></li>
</ul></div>
<div id="book-block-menu-11" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../../examples.html">Examples</a></li>
</ul></div>
<div id="book-block-menu-12" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../../tips.html">Tips</a></li>
</ul></div>
<div id="book-block-menu-32" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../../advanced.html">Advanced Topics</a></li>
</ul></div>
<div id="book-block-menu-24" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../../node/24.html">Other Articles</a></li>
</ul></div>
  </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-node-0" class="block block-node region-even even region-count-2 count-2"><div class="block-inner">

      <h2 class="title">Subscribe</h2>
  
  <div class="content">
    <a href="../../rss.xml" class="feed-icon"><img src="../../misc/feed.png" alt="Syndicate content" title="Syndicate" width="16" height="16" /></a>  </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-comment-0" class="block block-comment region-odd odd region-count-3 count-3"><div class="block-inner">

      <h2 class="title">Recent comments</h2>
  
  <div class="content">
    <div class="item-list"><ul><li class="first"><a href="../../mvvm-and-linq-to-sql.html#comment-687">No longer preferred</a><br />3 years 13 weeks ago</li>
<li><a href="../../mvvm-and-linq-to-sql.html#comment-684">Is this still the preferred way?</a><br />3 years 19 weeks ago</li>
<li><a href="../../tips/common_mistakes_observablecollection.html#comment-668" class="active">Wrong. When replacing the</a><br />3 years 44 weeks ago</li>
<li><a href="../../node/39.html#comment-667">Very nice</a><br />3 years 46 weeks ago</li>
<li><a href="../../node/39.html#comment-666">Example Application</a><br />3 years 47 weeks ago</li>
<li><a href="../../basics/make-command.html#comment-665">Responsibilities</a><br />4 years 3 days ago</li>
<li><a href="../../basics/make-command.html#comment-664">Menus</a><br />4 years 3 days ago</li>
<li><a href="../../tips/common_mistakes_observablecollection.html#comment-659" class="active">The reason that this is a</a><br />4 years 17 weeks ago</li>
<li><a href="../../tips/common_mistakes_observablecollection.html#comment-658" class="active">You need to explain why these</a><br />4 years 17 weeks ago</li>
<li class="last"><a href="../../validation.html#comment-657">RE: I like your approach, but ...</a><br />4 years 21 weeks ago</li>
</ul></div>  </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-user-0" class="block block-user region-even even region-count-4 count-4"><div class="block-inner">

      <h2 class="title">User login</h2>
  
  <div class="content">
    <form action="http://updatecontrols.net/doc/comment/reply/36?destination=comment%2Freply%2F36"  accept-charset="UTF-8" method="post" id="user-login-form">
<div><div class="form-item" id="edit-name-wrapper">
 <label for="edit-name">Username: <span class="form-required" title="This field is required.">*</span></label>
 <input type="text" maxlength="60" name="name" id="edit-name" size="15" value="" class="form-text required" />
</div>
<div class="form-item" id="edit-pass-wrapper">
 <label for="edit-pass">Password: <span class="form-required" title="This field is required.">*</span></label>
 <input type="password" name="pass" id="edit-pass"  maxlength="60"  size="15"  class="form-text required" />
</div>
<input type="submit" name="op" id="edit-submit" value="Log in"  class="form-submit" />
<div class="item-list"><ul><li class="first last"><a href="../../user/password.html" title="Request new password via e-mail.">Request new password</a></li>
</ul></div><input type="hidden" name="form_build_id" id="form-b320ba58b6f76b707ef32fa108d502ef" value="form-b320ba58b6f76b707ef32fa108d502ef"  />
<input type="hidden" name="form_id" id="edit-user-login-block" value="user_login_block"  />

</div></form>
  </div>

  
</div></div> <!-- /block-inner, /block -->
        </div></div> <!-- /#sidebar-left-inner, /#sidebar-left -->
      
      
    </div></div> <!-- /#main-inner, /#main -->

          <div id="footer"><div id="footer-inner" class="region region-footer">

        
        <div id="block-system-0" class="block block-system region-odd odd region-count-1 count-5"><div class="block-inner">

  
  <div class="content">
    <a href="http://drupal.org/"><img src="../../misc/powered-blue-80x15.png" alt="Powered by Drupal, an open source content management system" title="Powered by Drupal, an open source content management system" width="80" height="15" /></a>  </div>

  
</div></div> <!-- /block-inner, /block -->

      </div></div> <!-- /#footer-inner, /#footer -->
    
  </div></div> <!-- /#page-inner, /#page -->

  
  <script type="text/javascript" src="../../sites/all/modules/google_analytics/googleanalytics4b43.js?r"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
try{var pageTracker = _gat._getTracker("UA-389401-4");pageTracker._trackPageview();} catch(err) {}
//--><!]]>
</script>

</body>

<!-- Mirrored from updatecontrols.net/doc/comment/reply/36 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:55:37 GMT -->
</html>
