<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">


<!-- Mirrored from updatecontrols.net/doc/examples/awesome by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:54:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Awesome application | Update Controls .NET</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../blogapi/wlwmanifest.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../blogapi/rsd" />
<link rel="prev" href="vmworkshop/wpf.html" />
<link rel="up" href="../examples.html" />
<link rel="next" href="wp7_odata.html" />
<link rel="shortcut icon" href="../http_/updatecontrols.net/favicon.html" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/book/book4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/updatecontrols/html-elements4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/zen/zen/tabs4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/zen/zen/messages4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/zen/zen/block-editing4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/zen/zen/wireframes4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/updatecontrols/layout4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/updatecontrols/updatecontrols4b43.css?r" />
<link type="text/css" rel="stylesheet" media="print" href="../sites/all/themes/updatecontrols/print4b43.css?r" />
<!--[if IE]>
<link type="text/css" rel="stylesheet" media="all" href="/doc/sites/all/themes/zen/zen/ie.css?r" />
<![endif]-->
  <script type="text/javascript" src="../misc/jquery4b43.js?r"></script>
<script type="text/javascript" src="../misc/drupal4b43.js?r"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/doc/", "googleanalytics": { "trackOutgoing": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|avi|csv|doc|exe|flv|gif|gz|jpe?g|js|mp(3|4|e?g)|mov|pdf|phps|png|ppt|rar|sit|tar|torrent|txt|wma|wmv|xls|xml|zip" } });
//--><!]]>
</script>
</head>
<body class="not-front not-logged-in node-type-blog one-sidebar sidebar-left page-examples-awesome section-examples">

  <div id="page"><div id="page-inner">

    <a name="top" id="navigation-top"></a>
          <div id="skip-to-nav"><a href="#navigation">Skip to Navigation</a></div>
    
    <div id="header"><div id="header-inner" class="clear-block">

              <div id="logo-title">

                      <div id="logo"><a href="../index.html" title="Home" rel="home"><img src="../images/logosmall.jpg" alt="Home" id="logo-image" /></a></div>
          
                                    <div id="site-name"><strong>
                <a href="../index.html" title="Home" rel="home">
                Update Controls .NET                </a>
              </strong></div>
                      
          
        </div> <!-- /#logo-title -->
      
      
    </div></div> <!-- /#header-inner, /#header -->

    <div id="main"><div id="main-inner" class="clear-block with-navbar">

      <div id="content"><div id="content-inner">

        
        
                  <div id="content-header">
            <div class="breadcrumb"><a href="../index.html">Home</a> › <a href="../blog.html">Blogs</a> › <a href="../blog/1.html">MichaelLPerry&#039;s blog</a> › </div>                          <h1 class="title">Awesome application</h1>
                                                          </div> <!-- /#content-header -->
        
        <div id="content-area">
          <div id="node-21" class="node node-type-blog"><div class="node-inner">

  
  
  
      <div class="meta">
              <div class="submitted">
          Submitted by MichaelLPerry on Fri, 11/20/2009 - 23:00        </div>
      
          </div>
  
  <div class="content">
    <p>I presented Update Controls in WPF, Silverlight, and Winforms online for a bunch of folks <a href="http://notatpdc.com/">not at PDC</a>. You can download the <a href="../sites/default/files/NotAtPDC.zip">source code</a> and watch the <a href="http://updatecontrols.net/videos/NotAtPDC/NotAtPDC.html">recording</a> to follow along.</p>
<p><strong>The most awesome app ever</strong>    <br />The most awesome app ever is Excel. Actually, it’s Excel’s great grandfather VisiCalc. With these apps you express the relationship among parts of your data. The spreadsheet figures out when to recalculate and keep things up to date.</p>
<p>You can demonstrate the View Model pattern in Excel. Put your name in C1. That’s the data model. Then enter the formula “=C1” into B1. That’s the view model. It gets its data from the data model. It doesn’t store that data, it just interprets it for the benefit of a specific view. Finally, put the formula “=B1” into A1. This is your view. It binds to properties of your data model. It can’t do complex logic. That’s the View Model’s job.</p>
<p>I want to write my application the same way that I construct a spreadsheet. It should just know what depends upon what, and keep things up to date. That’s what I demonstrate with Update Controls.</p>
<p><strong>Don’t copy data</strong>    <br />The View Model does not make a copy of your data. It delegates to the Data Model. If data is stored in two places, it might get out of sync. If it’s stored in only one place, then there is no chance of inconsistency.</p>
<p>The View Model in this example does not have any fields, other than the references that are assigned during construction. If you are storing state in your data model, you are probably making a mistake. If that state is a copy of what’s in the Data Model, or it can be calculated from the Data Model, then delegate. If not consider moving it to a navigation model.</p>
<p><strong>Navigation model</strong>    <br />Your application exists for one purpose: to manage information in a specific problem domain. That is what goes into the Data Model. Everything else is there to help the user navigate through that information. That goes into the Navigation Model.</p>
<p>The Navigation Model keeps track of selected items. The selected item of a ListBox is bound to a property on the View Model. That property just delegates to the Navigation Model. Putting the user selection into the Navigation Model instead of directly binding controls to one another allows you to programmatically change the selection. All you do is change the property in the Navigation Model.</p>
<p>The Navigation Model also keeps track of search parameters. A TextBox is bound to a Filter property, which delegates to the Navigation Model. A where clause in the linq query in the View Model compares items to this Filter. Since the linq query references the Filter property, the list is dependent upon it. Changing the Filter updates the list.</p>
<p><strong>Rapidly added features</strong>    <br />Update Controls discovers dependencies for you. You don’t have to manage dependencies on your own. When you do your own dependency management, you have to touch old code to add a new feature. But when the system manages dependencies, you can add new code and the old code will continue to behave as expected. All you have to do is:</p>
<ul>
<li>Store domain data in the Data Model.</li>
<li>Store user selection and navigation in the Navigation Model.</li>
<li>Delegate from the View Model to either the Data or the Navigation Model: don’t store state in the View Model.</li>
<li>Use Independent on all Data and Navigation Model fields.</li>
<li>Use ForView.Wrap() on all DataContexts that you set through code.</li>
</ul>
  <div id="book-navigation-11" class="book-navigation">
    
        <div class="page-links clear-block">
              <a href="vmworkshop/wpf.html" class="page-previous" title="Go to previous page">‹ VM Workshop</a>
                    <a href="../examples.html" class="page-up" title="Go to parent page">up</a>
                    <a href="wp7_odata.html" class="page-next" title="Go to next page">Windows Phone 7 and OData ›</a>
          </div>
    
  </div>
  </div>

  <ul class="links inline"><li class="blog_usernames_blog first"><a href="../blog/1.html" title="Read MichaelLPerry&#039;s latest blog entries.">MichaelLPerry&#039;s blog</a></li>
<li class="comment_add last"><a href="../comment/reply/21.html#comment-form" title="Share your thoughts and opinions related to this posting.">Add new comment</a></li>
</ul>
</div></div> <!-- /node-inner, /node -->
  <div id="comments">
          <h2 id="comments-title">Comments</h2>
        <a id="comment-626"></a>
<div class="comment comment-published odd first comment-by-anon"><div class="comment-inner clear-block">

      <h3 class="title">
      <a href="awesome.html#comment-626" class="active">MVVM and NavigationModel for Windows Forms</a>          </h3>
  
  
  
  <div class="submitted">
    Submitted by Anonymous on Sun, 12/04/2011 - 05:46.  </div>

  <div class="content">
    <p>Hi Michael</p>
<p>I just started to explore UpdateControl and it looks awesome so far. I'd like to ask you, is there an example of the MVVM and NavigationModel pattern for Windows Forms? What I found so far was simple binding to business objects.</p>
<p>thanks</p>
      </div>

      <div class="links">
      <ul class="links"><li class="comment_reply first last"><a href="../comment/reply/21/626.html">reply</a></li>
</ul>    </div>
  
</div></div> <!-- /comment-inner, /comment -->
<div class="indented"><a id="comment-627"></a>
<div class="comment comment-published even comment-by-author"><div class="comment-inner clear-block">

      <h3 class="title">
      <a href="awesome.html#comment-627" class="active">MVVM and NavigationModel for Windows Forms</a>          </h3>
  
  
  
  <div class="submitted">
    Submitted by MichaelLPerry on Mon, 12/05/2011 - 10:00.  </div>

  <div class="content">
    <p>MVVM arose out of WPF data binding, and is not as compelling a patter for Windows Forms. WPF must data bind to properties. MVVM was a way of getting the right properties onto an object to make it suitable for data binding.</p>
<p>Update Controls for Windows Forms can data bind to methods, so a view model is not strictly necessary. You can put any code that you need to in a GetXxxx() event and it will work. The down side is that code in a GetXxxx() event is not testable. For anything but the most trivial of view code, you will want to move that elsewhere.</p>
<p>You could use a view model as your new repository of non-trivial view code. Either construct one in the view, or have one injected into the view. Let the view call its properties and methods to handle Gets and Sets. Then you can construct a view model outside of the view in order to test it.</p>
<p>You will find that most of the view code is trivial. You will get tired of passing all of this trivial code through the view model. So I would expose the model from the view model so that the view can access it directly when no complex logic is necessary. This is something I never do in WPF or Silverlight.</p>
<p>As for the navigation model, it is simply a model that is not persisted. It records the user's point-of-view as they navigate through the application. Things like UpdateListBox.SetSelectedItem() should write to the navigation model, and then other controls can read from it.</p>
<p>I haven't written up an MVVM sample for Windows Forms because the pattern doesn't always apply. My simple examples don't require a view model, and adding one would just clutter them. But for complex Windows Forms applications, I have introduced view models and navigation models.</p>
      </div>

      <div class="links">
      <ul class="links"><li class="comment_reply first last"><a href="../comment/reply/21/627.html">reply</a></li>
</ul>    </div>
  
</div></div> <!-- /comment-inner, /comment -->
<div class="indented"><a id="comment-628"></a>
<div class="comment comment-published odd comment-by-anon"><div class="comment-inner clear-block">

      <h3 class="title">
      <a href="awesome.html#comment-628" class="active">MVVM and NavigationModel for Windows Forms</a>          </h3>
  
  
  
  <div class="submitted">
    Submitted by Anonymous on Tue, 12/06/2011 - 07:01.  </div>

  <div class="content">
    <p>Thank you for the detailed answer. Just one more question. If I understand correctly, with UpdateControls there is no need to use BindingSource in controls to communicate with the view model. Isn't it very cumbersome to write the OnGet/OnSet event handlers for all controls, or you use UpdateControls only for dependent controls?</p>
      </div>

      <div class="links">
      <ul class="links"><li class="comment_reply first last"><a href="../comment/reply/21/628.html">reply</a></li>
</ul>    </div>
  
</div></div> <!-- /comment-inner, /comment -->
<div class="indented"><a id="comment-629"></a>
<div class="comment comment-published even last comment-by-author"><div class="comment-inner clear-block">

      <h3 class="title">
      <a href="awesome.html#comment-629" class="active">Event handlers vs. control properties</a>          </h3>
  
  
  
  <div class="submitted">
    Submitted by MichaelLPerry on Tue, 12/06/2011 - 13:19.  </div>

  <div class="content">
    <p>You are correct. You don't need to set BindingSource to communicate with the view model. The Get and Set event handlers just need to reference the view model.</p>
<p>I find writing Get/Set events to be a reasonable trade-off. I'll even do that if my form does not exhibit inter-dependency.</p>
<p>The traditional way of working with Windows Forms applications is to load up control properties with initial values when the form loads, and then copy the values out of those properties when you're done. The control properties store your user's data while they work with it.</p>
<p>The Update Controls way is to bind the controls to the model (possibly through a view model) with the Get/Set events. The model stores your user's data, not the control properties.</p>
<p>I find this to be a reasonable trade-off because I don't have to write the load/unload code. It ends up being more lines-of-code to say the same thing, but it gives me the flexibility to add inter-dependent behavior later should I need it.</p>
      </div>

      <div class="links">
      <ul class="links"><li class="comment_reply first last"><a href="../comment/reply/21/629.html">reply</a></li>
</ul>    </div>
  
</div></div> <!-- /comment-inner, /comment -->
</div></div></div>  </div>
        </div>

        
        
      </div></div> <!-- /#content-inner, /#content -->

              <div id="navbar"><div id="navbar-inner" class="clear-block region region-navbar">

          <a name="navigation" id="navigation"></a>

          
                      <div id="primary">
              <ul class="links"><li class="menu-146 first"><a href="../../cs/index-2.html" title="">WPF</a></li>
<li class="menu-147"><a href="../../cs/silverlight.html" title="">Silverlight</a></li>
<li class="menu-148"><a href="../../cs/winforms.html" title="">Winforms</a></li>
<li class="menu-149"><a href="../../cs/download.html" title="">Download</a></li>
<li class="menu-150"><a href="../index.html" title="">Documentation</a></li>
<li class="menu-151"><a href="../../cs/videos.html" title="">Videos</a></li>
<li class="menu-152 last"><a href="../../cs/contact.html" title="">Contact Us</a></li>
</ul>            </div> <!-- /#primary -->
          
          
          
        </div></div> <!-- /#navbar-inner, /#navbar -->
      
              <div id="sidebar-left"><div id="sidebar-left-inner" class="region region-left">
          <div id="block-book-0" class="block block-book region-odd odd region-count-1 count-1"><div class="block-inner">

      <h2 class="title">Sections</h2>
  
  <div class="content">
    <div id="book-block-menu-43" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../basics.html">The Basics</a></li>
</ul></div>
<div id="book-block-menu-11" class="book-block-menu">
  <ul class="menu"><li class="expanded first last active-trail"><a href="../examples.html">Examples</a><ul class="menu"><li class="leaf first"><a href="menus.html">Menus</a></li>
<li class="collapsed"><a href="treeview/non_recursive.html">TreeView</a></li>
<li class="leaf"><a href="icommand.html">ICommand</a></li>
<li class="leaf"><a href="linq.html">Linq</a></li>
<li class="leaf"><a href="../mvvm-and-linq-to-sql.html">Linq to SQL</a></li>
<li class="leaf"><a href="multi-threading.html">Multi-threading</a></li>
<li class="leaf"><a href="twolists.html">Two lists</a></li>
<li class="leaf"><a href="vmworkshop/wpf.html">VM Workshop</a></li>
<li class="leaf active-trail"><a href="awesome.html" class="active">Awesome application</a></li>
<li class="leaf"><a href="wp7_odata.html">Windows Phone 7 and OData</a></li>
<li class="leaf last"><a href="mvc-without-eventing.html">MVC without eventing</a></li>
</ul></li>
</ul></div>
<div id="book-block-menu-12" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../tips.html">Tips</a></li>
</ul></div>
<div id="book-block-menu-32" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../advanced.html">Advanced Topics</a></li>
</ul></div>
<div id="book-block-menu-24" class="book-block-menu">
  <ul class="menu"><li class="collapsed first last"><a href="../node/24.html">Other Articles</a></li>
</ul></div>
  </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-node-0" class="block block-node region-even even region-count-2 count-2"><div class="block-inner">

      <h2 class="title">Subscribe</h2>
  
  <div class="content">
    <a href="../rss.xml" class="feed-icon"><img src="../misc/feed.png" alt="Syndicate content" title="Syndicate" width="16" height="16" /></a>  </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-comment-0" class="block block-comment region-odd odd region-count-3 count-3"><div class="block-inner">

      <h2 class="title">Recent comments</h2>
  
  <div class="content">
    <div class="item-list"><ul><li class="first"><a href="../mvvm-and-linq-to-sql.html#comment-687">No longer preferred</a><br />3 years 13 weeks ago</li>
<li><a href="../mvvm-and-linq-to-sql.html#comment-684">Is this still the preferred way?</a><br />3 years 19 weeks ago</li>
<li><a href="../tips/common_mistakes_observablecollection.html#comment-668" class="active">Wrong. When replacing the</a><br />3 years 44 weeks ago</li>
<li><a href="../node/39.html#comment-667">Very nice</a><br />3 years 46 weeks ago</li>
<li><a href="../node/39.html#comment-666">Example Application</a><br />3 years 47 weeks ago</li>
<li><a href="../basics/make-command.html#comment-665">Responsibilities</a><br />4 years 3 days ago</li>
<li><a href="../basics/make-command.html#comment-664">Menus</a><br />4 years 3 days ago</li>
<li><a href="../tips/common_mistakes_observablecollection.html#comment-659" class="active">The reason that this is a</a><br />4 years 17 weeks ago</li>
<li><a href="../tips/common_mistakes_observablecollection.html#comment-658" class="active">You need to explain why these</a><br />4 years 17 weeks ago</li>
<li class="last"><a href="../validation.html#comment-657">RE: I like your approach, but ...</a><br />4 years 21 weeks ago</li>
</ul></div>  </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-user-0" class="block block-user region-even even region-count-4 count-4"><div class="block-inner">

      <h2 class="title">User login</h2>
  
  <div class="content">
    <form action="http://updatecontrols.net/doc/examples/awesome?destination=node%2F21"  accept-charset="UTF-8" method="post" id="user-login-form">
<div><div class="form-item" id="edit-name-wrapper">
 <label for="edit-name">Username: <span class="form-required" title="This field is required.">*</span></label>
 <input type="text" maxlength="60" name="name" id="edit-name" size="15" value="" class="form-text required" />
</div>
<div class="form-item" id="edit-pass-wrapper">
 <label for="edit-pass">Password: <span class="form-required" title="This field is required.">*</span></label>
 <input type="password" name="pass" id="edit-pass"  maxlength="60"  size="15"  class="form-text required" />
</div>
<input type="submit" name="op" id="edit-submit" value="Log in"  class="form-submit" />
<div class="item-list"><ul><li class="first last"><a href="../user/password.html" title="Request new password via e-mail.">Request new password</a></li>
</ul></div><input type="hidden" name="form_build_id" id="form-e44d548d9bb6c159931ae87103719ebf" value="form-e44d548d9bb6c159931ae87103719ebf"  />
<input type="hidden" name="form_id" id="edit-user-login-block" value="user_login_block"  />

</div></form>
  </div>

  
</div></div> <!-- /block-inner, /block -->
        </div></div> <!-- /#sidebar-left-inner, /#sidebar-left -->
      
      
    </div></div> <!-- /#main-inner, /#main -->

          <div id="footer"><div id="footer-inner" class="region region-footer">

        
        <div id="block-system-0" class="block block-system region-odd odd region-count-1 count-5"><div class="block-inner">

  
  <div class="content">
    <a href="http://drupal.org/"><img src="../misc/powered-blue-80x15.png" alt="Powered by Drupal, an open source content management system" title="Powered by Drupal, an open source content management system" width="80" height="15" /></a>  </div>

  
</div></div> <!-- /block-inner, /block -->

      </div></div> <!-- /#footer-inner, /#footer -->
    
  </div></div> <!-- /#page-inner, /#page -->

  
  <script type="text/javascript" src="../sites/all/modules/google_analytics/googleanalytics4b43.js?r"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
try{var pageTracker = _gat._getTracker("UA-389401-4");pageTracker._trackPageview();} catch(err) {}
//--><!]]>
</script>

</body>

<!-- Mirrored from updatecontrols.net/doc/examples/awesome by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:54:36 GMT -->
</html>
